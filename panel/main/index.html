<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hejteri Panel</title>
    <link rel="icon" href="https://raw.githubusercontent.com/hejteri/hejteri.github.io/main/hejteri/hejteri.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/hejteri/hejteri.github.io/hejteri/main.css">

    <body>
        <header>
            <a href="https://hejteri.github.io/panel" class="title">Hejteri Panel</a>
            <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
            <nav>
                <a href="https://hejteri.github.io">Home</a>
                <a href="" id="loginbut"></a>
            </nav>
        </header>
        <div class="panel-container">
            <section class="panel-section">
                <input type="text" id="sectionTitle1" placeholder="Section-1">
                <textarea id="dataInput1" rows="10"></textarea>
                <button id="saveButton1" onclick="Show(1)">Save Changes</button>
                <div class="button-group" id="button-group-1">
                    <button onclick="cancelChanges(1)">Cancel</button>
                    <button onclick="saveChanges(1)">Confirm</button>
                </div>
            </section>
            <section class="panel-section">
                <input type="text" id="sectionTitle2" placeholder="Section-2">
                <textarea id="dataInput2" rows="10"></textarea>
                <button id="saveButton2" onclick="Show(2)">Save Changes</button>
                <div class="button-group" id="button-group-2">
                    <button onclick="cancelChanges(2)">Cancel</button>
                    <button onclick="saveChanges(2)">Confirm</button>
                </div>
            </section>
            <section class="panel-section">
                <input type="text" id="sectionTitle3" placeholder="Section-3">
                <textarea id="dataInput3" rows="10"></textarea>
                <button id="saveButton3" onclick="Show(3)">Save Changes</button>
                <div class="button-group" id="button-group-3">
                    <button onclick="cancelChanges(3)">Cancel</button>
                    <button onclick="saveChanges(3)">Confirm</button>
                </div>
            </section>
            <section class="panel-section">
                <input type="text" id="sectionTitle4" placeholder="Section-4">
                <textarea id="dataInput4" rows="10"></textarea>
                <button id="saveButton4" onclick="Show(4)">Save Changes</button>
                <div class="button-group" id="button-group-4">
                    <button onclick="cancelChanges(4)">Cancel</button>
                    <button onclick="saveChanges(4)">Confirm</button>
                </div>
            </section>
        </div>
        <footer class="footer-content">
            <p>&copy; 2018-2024 Hejteri Organization. All rights reserved.</p>
            <b>Designed by ROOT256</b>
        </footer>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/hejteri/hejteri.github.io/hejteri/main.js"></script>
        <script>
            var redi2 = true;

            function login() {
                const usernamePrefix = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const username = usernamePrefix + "@hejteri.com";
                const errorOverlay = document.getElementById('error-overlay');
                const errorBox = document.getElementById('error-box');
                const errorText = document.getElementById('error-text');

                auth.signInWithEmailAndPassword(username, password)
                    .then((userCredential) => { location.reload() })
                    .catch((error) => {
                        const errorCode = error.code;
                        let errorMessage = "";

                        switch (errorCode) {
                            case "auth/user-not-found":
                            case "auth/invalid-email":
                            case "auth/wrong-password":
                            case "auth/internal-error":
                                errorMessage = "Incorrect Username/Password";
                                break;
                            default:
                                errorText.textContent = errorMessage;
                        }

                        errorText.textContent = errorMessage;
                        errorOverlay.style.display = 'block';
                        errorBox.style.display = 'block';
                    });
            }

            function closeErrorBox() {
                const errorOverlay = document.getElementById('error-overlay');
                const errorBox = document.getElementById('error-box');
                errorOverlay.style.display = 'none';
                errorBox.style.display = 'none';
            }

            function hideButtons() {
                const buttonGroups = document.querySelectorAll('.button-group');
                buttonGroups.forEach((buttonGroup) => {
                    const buttons = buttonGroup.querySelectorAll('button');
                    buttons.forEach((button) => {
                        button.style.display = 'none';
                    });
                });
            }

            function Show(pageNumber) {
                const saveButton = document.querySelector(`#saveButton${pageNumber}`);
                saveButton.style.display = 'none';

                const buttonGroup = document.querySelector(`#button-group-${pageNumber}`);
                const buttons = buttonGroup.querySelectorAll('button');
                buttons.forEach((button) => {
                    button.style.display = 'block';
                });
            }

            function cancelChanges(pageNumber) {
                const saveButton = document.querySelector(`#saveButton${pageNumber}`);
                saveButton.style.display = 'block';

                const buttonGroup = document.querySelector(`#button-group-${pageNumber}`);
                const buttons = buttonGroup.querySelectorAll('button');
                buttons.forEach((button) => {
                    button.style.display = 'none';
                });
            }

            function saveChanges(pageNumber) {
                AuthButtons();
                const titleInput = document.getElementById(`sectionTitle${pageNumber}`);
                const dataInput = document.getElementById(`dataInput${pageNumber}`);
                const saveButton = document.querySelector(`#saveButton${pageNumber}`);
                const buttonGroup = document.querySelector(`#button-group-${pageNumber}`);

                const titleData = titleInput.value.trim();

                let inputData;

                if (pageNumber === 3) {
                    inputData = dataInput.value.trim().replace(/\n/g, '\\n');
                } else {
                    inputData = dataInput.value.trim().replace(/\n/g, '\n');
                }

                const titleRef = firebase.database().ref(`pages/home/${pageNumber}/head`);
                const textRef = firebase.database().ref(`pages/home/${pageNumber}/text`);

                Promise.all([
                    titleRef.once("value"),
                    textRef.once("value")
                ]).then(([titleSnapshot, textSnapshot]) => {
                    titleRef.set(titleData);
                    textRef.set(inputData);

                    const buttons = buttonGroup.querySelectorAll('button');
                    buttons.forEach((button) => {
                        button.style.display = 'none';
                    });

                    saveButton.style.display = 'block';
                    alert("Saved Section-" + pageNumber + "!");
                });
            }

            function loadData() {
                for (let i = 1; i <= 4; i++) {
                    const titleRef = firebase.database().ref(`pages/home/${i}/head`);
                    const textRef = firebase.database().ref(`pages/home/${i}/text`);

                    titleRef.once("value")
                        .then((titleSnapshot) => {
                            const titleData = titleSnapshot.val();
                            const titleInput = document.getElementById(`sectionTitle${i}`);

                            if (titleData) {
                                titleInput.value = titleData.trim();
                            }
                        })
                        .catch((error) => console.error(`Error loading title for page ${i}:`, error));

                    textRef.once("value")
                        .then((textSnapshot) => {
                            const textData = textSnapshot.val();
                            const dataInput = document.getElementById(`dataInput${i}`);

                            if (textData) {
                                if (i === 4) {
                                    const lines = textData.split('\\n').join('');
                                    dataInput.value = lines.trim();
                                } else {
                                    const lines = textData.split('\\n').join('\n');
                                    dataInput.value = lines.trim();
                                }
                            }
                        })
                        .catch((error) => console.error(`Error loading data for page ${i}:`, error));
                }
            }

            window.onload = function () {
                AuthButtons();
                loadData();
                hideButtons();
            }
        </script>
    </body>

</html>
